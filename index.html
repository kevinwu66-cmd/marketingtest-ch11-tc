<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é›¶å”®èˆ‡æ‰¹ç™¼è¡ŒéŠ·å¤§å¸«ï¼šCh11 çŸ¥è­˜æŒ‘æˆ°è³½</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* --- è¦–è¦ºé¢¨æ ¼ (å¾©åˆ» survey1.html & survey2.html) --- */
        :root {
            --bg-gradient: linear-gradient(135deg, #1a237e 0%, #512da8 100%);
            --glass-bg: rgba(30, 34, 90, 0.85);
            --glass-border: rgba(110, 180, 255, 0.18);
            --neon-blue: #00e5ff;
            --neon-purple: #7c4dff;
            --neon-yellow: #fff176;
            --text-main: #ffffff;
            --text-sub: #b3e5fc;
            --card-bg: rgba(255, 255, 255, 0.08);
            --accent-gradient: linear-gradient(90deg, #7c4dff 0%, #00bcd4 100%);
            --success-color: #00e676;
            --error-color: #ff5252;
        }

        body {
            margin: 0;
            font-family: 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;
            background: var(--bg-gradient);
            color: var(--text-main);
            min-height: 100vh;
            overflow-x: hidden;
            display: flex;
            justify-content: center;
        }

        /* èƒŒæ™¯ç´‹ç† */
        .bg-pattern {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: url('https://www.transparenttextures.com/patterns/hexellence.png');
            opacity: 0.15;
            pointer-events: none;
            z-index: 0;
        }

        /* ç²’å­å‹•ç•« */
        .particle {
            position: fixed;
            border-radius: 50%;
            pointer-events: none;
            opacity: 0.6;
            animation: float 6s infinite ease-in-out;
            z-index: 0;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        /* --- ä¸»å®¹å™¨ (Mobile First) --- */
        .app-container {
            position: relative;
            z-index: 1;
            width: 100%;
            max-width: 480px;
            min-height: 100vh;
            background: rgba(20, 20, 40, 0.3);
            backdrop-filter: blur(5px);
            display: flex;
            flex-direction: column;
            padding: 16px;
            box-sizing: border-box;
        }

        /* --- Header --- */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 10px;
            background: var(--card-bg);
            border-radius: 16px;
            border: 1px solid var(--glass-border);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .header-title {
            font-size: 1.1rem;
            font-weight: 900;
            text-shadow: 0 0 8px var(--neon-purple);
        }

        .progress-badge {
            background: rgba(0, 229, 255, 0.15);
            color: var(--neon-blue);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.9rem;
            border: 1px solid var(--neon-blue);
            font-weight: bold;
        }

        /* --- Quiz Area --- */
        .quiz-card {
            background: var(--glass-bg);
            border-radius: 24px;
            padding: 24px;
            border: 1px solid var(--glass-border);
            box-shadow: 0 4px 32px rgba(80,100,255,0.18);
            margin-bottom: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 24px;
            line-height: 1.5;
            color: #fff;
            min-height: 60px;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option-btn {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 16px;
            border-radius: 16px;
            text-align: left;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }

        .option-btn:hover {
            background: rgba(33, 150, 243, 0.2);
            border-color: var(--neon-blue);
        }

        .option-btn.selected {
            background: rgba(0, 229, 255, 0.2);
            border-color: var(--neon-blue);
            box-shadow: 0 0 10px rgba(0, 229, 255, 0.3);
        }

        .btn-action {
            margin-top: auto;
            background: var(--accent-gradient);
            color: white;
            border: none;
            padding: 14px 0;
            font-size: 1.1rem;
            border-radius: 25px;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(124, 77, 255, 0.4);
            font-weight: bold;
            width: 100%;
            transition: transform 0.2s;
            text-align: center;
        }

        .btn-action:active { transform: scale(0.98); }
        .btn-action:disabled { 
            background: #555; 
            cursor: not-allowed; 
            box-shadow: none;
            opacity: 0.6;
        }

        /* --- Modal & Overlays --- */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.85);
            backdrop-filter: blur(8px);
            z-index: 100;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        .modal-overlay.active { opacity: 1; pointer-events: auto; }

        .modal-content {
            width: 90%;
            max-width: 420px;
            background: linear-gradient(145deg, rgba(40, 44, 100, 0.95), rgba(20, 20, 60, 0.95));
            border: 1px solid var(--neon-purple);
            border-radius: 24px;
            padding: 28px;
            text-align: center;
            box-shadow: 0 0 30px rgba(124, 77, 255, 0.3);
            max-height: 85vh;
            overflow-y: auto;
        }

        .modal-title {
            font-size: 1.6rem;
            font-weight: 900;
            margin-bottom: 16px;
            background: -webkit-linear-gradient(90deg, #00e5ff, #b388ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .info-block {
            text-align: left;
            margin-bottom: 20px;
            background: rgba(255,255,255,0.05);
            padding: 16px;
            border-radius: 12px;
            border-left: 4px solid var(--neon-blue);
        }
        .info-label { color: var(--neon-blue); font-weight: bold; margin-bottom: 6px; font-size: 0.9rem; }
        .info-text { color: #e0e0e0; font-size: 0.95rem; line-height: 1.5; }

        /* --- Result Page Styles --- */
        .result-score-container {
            position: relative;
            width: 140px;
            height: 140px;
            margin: 0 auto 20px auto;
        }
        .score-text {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2.2rem; /* ç¨å¾®ç¸®å°å­—é«”ä»¥å®¹ç´100åˆ† */
            font-weight: 900;
            color: var(--neon-yellow);
            text-shadow: 0 0 10px rgba(255, 241, 118, 0.6);
        }
        
        .feedback-text {
            font-size: 1.1rem;
            color: #fff;
            margin-bottom: 24px;
            line-height: 1.6;
            font-weight: 500;
        }

        .review-list {
            text-align: left;
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .review-item {
            background: rgba(255,255,255,0.05);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .review-item.correct { border-left: 4px solid var(--success-color); }
        .review-item.wrong { border-left: 4px solid var(--error-color); }

        .review-q { font-weight: bold; margin-bottom: 8px; color: #fff; }
        .review-a { font-size: 0.9rem; color: #bdbdbd; margin-bottom: 4px; }
        .review-exp { 
            font-size: 0.85rem; 
            color: var(--text-sub); 
            margin-top: 8px; 
            background: rgba(0, 229, 255, 0.1); 
            padding: 8px; 
            border-radius: 8px; 
        }

    </style>
</head>
<body>

    <div class="bg-pattern"></div>
    <div class="particle" style="width:12px; height:12px; top:15%; left:10%; background:var(--neon-blue);"></div>
    <div class="particle" style="width:18px; height:18px; top:60%; left:85%; background:var(--neon-purple); animation-delay: 1s;"></div>
    <div class="particle" style="width:8px; height:8px; top:30%; left:50%; background:var(--neon-yellow); animation-delay: 2s;"></div>
    <div class="particle" style="width:10px; height:10px; top:80%; left:20%; background:#ff4081; animation-delay: 3s;"></div>

    <div class="app-container">
        <div class="modal-overlay active" id="welcome-modal">
            <div class="modal-content">
                <div class="modal-title">è¡ŒéŠ·çŸ¥è­˜æŒ‘æˆ°è³½</div>
                
                <div class="info-block">
                    <div class="info-label">ğŸ¯ æŒ‘æˆ°ç›®æ¨™</div>
                    <div class="info-text">æ¸¬è©¦æ‚¨å°è¡ŒéŠ·å­¸ç¬¬11ç« ã€Œé›¶å”®èˆ‡æ‰¹ç™¼ (Retailing and Wholesaling)ã€çš„æŒæ¡ç¨‹åº¦ï¼Œå…±20é“ç²¾é¸è©¦é¡Œã€‚</div>
                </div>

                <div class="info-block">
                    <div class="info-label">ğŸ® æ“ä½œæ–¹å¼</div>
                    <div class="info-text">é»æ“Šé¸é …å›ç­”å•é¡Œï¼Œæ¯é¡Œ5åˆ†ï¼Œç¸½åˆ†100åˆ†ã€‚ç­”é¡Œå¾Œç„¡æ³•ä¿®æ”¹ï¼Œè«‹è¬¹æ…é¸æ“‡ã€‚</div>
                </div>

                <div class="info-block">
                    <div class="info-label">ğŸ† å­¸ç¿’æˆæœ</div>
                    <div class="info-text">å¼·åŒ–å°é›¶å”®å•†é¡å‹ã€å…¨é€šè·¯è¡ŒéŠ·ã€é›¶å”®è¡ŒéŠ·æ±ºç­–åŠæ‰¹ç™¼å•†è·èƒ½çš„ç†è§£ã€‚</div>
                </div>

                <button class="btn-action" onclick="startGame()">é–‹å§‹æ¸¬é©—</button>
            </div>
        </div>

        <div id="game-ui" style="display: none; height: 100%; flex-direction: column; flex:1;">
            <div class="header">
                <div class="header-title">CH11: Retailing & Wholesaling</div>
                <div class="progress-badge" id="progress-text">Q 1/20</div>
            </div>

            <div class="quiz-card">
                <div class="question-text" id="question-text">é¡Œç›®è¼‰å…¥ä¸­...</div>
                <div class="options-container" id="options-container">
                    </div>
            </div>

            <button class="btn-action" id="next-btn" onclick="nextQuestion()" disabled>ä¸‹ä¸€é¡Œ</button>
        </div>

        <div class="modal-overlay" id="result-modal">
            <div class="modal-content" style="max-width: 500px;">
                <div class="modal-title">æ¸¬é©—çµæœ</div>
                
                <div class="result-score-container">
                    <canvas id="scoreChart"></canvas>
                    <div class="score-text" id="final-score">0</div>
                </div>

                <div class="feedback-text" id="final-feedback">è©•èªè¼‰å…¥ä¸­...</div>
                
                <div class="info-block" style="max-height: 300px; overflow-y: auto;">
                    <div class="info-label">ğŸ“ ç­”é¡Œè©³è§£</div>
                    <div class="review-list" id="review-list">
                        </div>
                </div>

                <button class="btn-action" onclick="location.reload()">é‡æ–°æŒ‘æˆ°</button>
            </div>
        </div>

    </div>

    <script>
        // --- é¡Œåº«è³‡æ–™ (åŸºæ–¼ Ch11.pdf) ---
        const questionsSource = [
            {
                q: "ã€Œé›¶å”® (Retailing)ã€çš„ä¸»è¦å®šç¾©æ˜¯ä»€éº¼ï¼Ÿ",
                a: "å°‡å•†å“æˆ–æœå‹™ç›´æ¥éŠ·å”®çµ¦æœ€çµ‚æ¶ˆè²»è€…ä»¥ä¾›å€‹äººä½¿ç”¨çš„æ‰€æœ‰æ´»å‹•",
                options: ["å°‡å•†å“æˆ–æœå‹™ç›´æ¥éŠ·å”®çµ¦æœ€çµ‚æ¶ˆè²»è€…ä»¥ä¾›å€‹äººä½¿ç”¨çš„æ‰€æœ‰æ´»å‹•", "å°‡å•†å“å¤§é‡éŠ·å”®çµ¦ä¼æ¥­ç”¨æˆ¶é€²è¡Œè½‰å”®çš„æ´»å‹•", "è£½é€ å•†ç›´æ¥ç”Ÿç”¢å•†å“ä¸¦å„²å­˜çš„éç¨‹", "åƒ…é™æ–¼åœ¨å¯¦é«”å•†åº—å…§é€²è¡Œçš„å•†å“äº¤æ›è¡Œç‚º"],
                exp: "æ ¹æ“š Ch11ï¼Œé›¶å”®æ¶‰åŠå°‡å•†å“æˆ–æœå‹™ç›´æ¥éŠ·å”®çµ¦æœ€çµ‚æ¶ˆè²»è€…ä¾›å…¶å€‹äººã€éå•†æ¥­ç”¨é€”çš„æ‰€æœ‰æ´»å‹•ã€‚"
            },
            {
                q: "ä»€éº¼æ˜¯ã€Œå…¨é€šè·¯é›¶å”® (Omni-channel retailing)ã€çš„æ ¸å¿ƒæ¦‚å¿µï¼Ÿ",
                a: "å‰µé€ æ•´åˆåº—å…§ã€ç·šä¸ŠåŠè¡Œå‹•è³¼ç‰©çš„ç„¡ç¸«è·¨é€šè·¯è³¼è²·é«”é©—",
                options: ["å‰µé€ æ•´åˆåº—å…§ã€ç·šä¸ŠåŠè¡Œå‹•è³¼ç‰©çš„ç„¡ç¸«è·¨é€šè·¯è³¼è²·é«”é©—", "å°ˆæ³¨æ–¼å–®ä¸€æœ€å¼·å‹¢çš„éŠ·å”®é€šè·¯ä»¥æ¥µå¤§åŒ–åˆ©æ½¤", "å®Œå…¨æ”¾æ£„å¯¦é«”åº—é¢ï¼Œè½‰å‘ç´”é›»å•†ç¶“ç‡Ÿ", "å°‡ä¸åŒé€šè·¯çš„åº«å­˜èˆ‡è¡ŒéŠ·æ´»å‹•å®Œå…¨ç¨ç«‹é‹ä½œ"],
                exp: "å…¨é€šè·¯é›¶å”®æ—¨åœ¨æ•´åˆåº—å…§ã€ç·šä¸Šå’Œç§»å‹•è³¼ç‰©ï¼Œç‚ºæ¶ˆè²»è€…å‰µé€ ç„¡ç¸«çš„è·¨é€šè·¯è³¼è²·é«”é©—ã€‚"
            },
            {
                q: "é—œæ–¼ã€Œå°ˆè³£åº— (Specialty store)ã€ï¼Œä¸‹åˆ—æè¿°ä½•è€…æ­£ç¢ºï¼Ÿ",
                a: "éŠ·å”®ç‹¹çª„çš„ç”¢å“ç·šï¼Œä½†åœ¨è©²ç”¢å“ç·šä¸­æ“æœ‰æ·±åº¦çš„ç”¢å“çµ„åˆ",
                options: ["éŠ·å”®ç‹¹çª„çš„ç”¢å“ç·šï¼Œä½†åœ¨è©²ç”¢å“ç·šä¸­æ“æœ‰æ·±åº¦çš„ç”¢å“çµ„åˆ", "éŠ·å”®å»£æ³›çš„ç”¢å“ç·šï¼Œä½†æ¯ç¨®ç”¢å“çš„é¸æ“‡æœ‰é™", "ä»¥ä½åˆ©æ½¤ã€é«˜å‘¨è½‰ç‡çš„æ–¹å¼éŠ·å”®æ—¥å¸¸ç”¨å“", "ä¸»è¦éŠ·å”®é£Ÿå“å’Œéé£Ÿå“é¡çš„å®¶åº­ç”¨å“ï¼Œè¦æ¨¡å·¨å¤§"],
                exp: "å°ˆè³£åº— (å¦‚ REI, Sephora) çš„ç‰¹å¾µæ˜¯ç”¢å“ç·šçª„ (Narrow product line) ä½†çµ„åˆæ·± (Deep assortment)ã€‚"
            },
            {
                q: "ä¸‹åˆ—å“ªç¨®é¡å‹çš„é›¶å”®å•†ç‰¹å¾µæ˜¯ã€Œç›¸å°è¼ƒå¤§ã€ä½æˆæœ¬ã€ä½åˆ©æ½¤ã€é«˜éŠ·é‡ã€è‡ªåŠ©å¼ã€ï¼Ÿ",
                a: "è¶…ç´šå¸‚å ´ (Supermarket)",
                options: ["è¶…ç´šå¸‚å ´ (Supermarket)", "ä¾¿åˆ©å•†åº— (Convenience store)", "å°ˆè³£åº— (Specialty store)", "ç™¾è²¨å…¬å¸ (Department store)"],
                exp: "é€™æ˜¯è¶…ç´šå¸‚å ´ (å¦‚ Kroger, Publix) çš„æ¨™æº–å®šç¾©ï¼šå¤§å‹ã€ä½æˆæœ¬ã€ä½åˆ©æ½¤ã€é«˜éŠ·é‡ä¸”è‡ªåŠ©å¼ã€‚"
            },
            {
                q: "åƒ 7-Eleven é€™æ¨£ä½æ–¼ä½å®…å€é™„è¿‘ã€å…¨å¤©å€™ç‡Ÿæ¥­ä¸¦éŠ·å”®é«˜å‘¨è½‰ç‡å•†å“çš„å•†åº—å±¬æ–¼ï¼Ÿ",
                a: "ä¾¿åˆ©å•†åº— (Convenience store)",
                options: ["ä¾¿åˆ©å•†åº— (Convenience store)", "è¶…ç´šå•†åº— (Superstore)", "æŠ˜æ‰£åº— (Discount store)", "æš¢è²¨ä¸­å¿ƒ (Factory outlet)"],
                exp: "ä¾¿åˆ©å•†åº—è¦æ¨¡è¼ƒå°ï¼Œé è¿‘ä½å®…å€ï¼Œé•·æ™‚é–“ç‡Ÿæ¥­ï¼Œä¸»æ‰“é«˜å‘¨è½‰ç‡çš„ä¾¿åˆ©å•†å“ã€‚"
            },
            {
                q: "ä»€éº¼æ˜¯ã€Œå“é¡æ®ºæ‰‹ (Category Killer)ã€ï¼Ÿ",
                a: "åœ¨ç‰¹å®šé¡åˆ¥ä¸­æä¾›æ¥µæ·±ç”¢å“çµ„åˆçš„å¤§å‹å°ˆè³£åº—",
                options: ["åœ¨ç‰¹å®šé¡åˆ¥ä¸­æä¾›æ¥µæ·±ç”¢å“çµ„åˆçš„å¤§å‹å°ˆè³£åº—", "éŠ·å”®éå­£å•†å“æˆ–æ¬¡ç´šå“çš„é›¶å”®å•†", "ç”±è£½é€ å•†ç›´æ¥æ“æœ‰çš„é›¶å”®æ“šé»", "æ”¶å–æœƒå“¡è²»ä¸¦ä»¥æ‰¹ç™¼åƒ¹éŠ·å”®å•†å“çš„ä¿±æ¨‚éƒ¨"],
                exp: "å“é¡æ®ºæ‰‹ (å¦‚ Best Buy, Petco) æ˜¯å¤§å‹å°ˆè³£åº—ï¼Œåœ¨ç‰¹å®šé¡åˆ¥ä¸­æ“æœ‰æ¥µæ·±çš„ç”¢å“çµ„åˆï¼Œå¸¸ä½¿åŒé¡åˆ¥çš„å°åº—é›£ä»¥ç”Ÿå­˜ã€‚"
            },
            {
                q: "ä»¥ä½æ–¼æ­£å¸¸æ‰¹ç™¼åƒ¹è³¼è²·å•†å“ï¼Œä¸¦ä»¥ä½æ–¼é›¶å”®åƒ¹éŠ·å”®çš„é›¶å”®å•†ç¨±ç‚ºï¼Ÿ",
                a: "é™åƒ¹é›¶å”®å•† (Off-price retailer)",
                options: ["é™åƒ¹é›¶å”®å•† (Off-price retailer)", "æŠ˜æ‰£åº— (Discount store)", "ç™¾è²¨å…¬å¸ (Department store)", "è¶…ç´šå•†åº— (Superstore)"],
                exp: "é™åƒ¹é›¶å”®å•† (å¦‚ TJ Maxx, Costco) çš„ç‰¹å¾µæ˜¯ä»¥ä½æ–¼æ­£å¸¸æ‰¹ç™¼åƒ¹é€²è²¨ï¼Œä¸¦ä»¥ä½æ–¼ä¸€èˆ¬é›¶å”®åƒ¹éŠ·å”®ã€‚"
            },
            {
                q: "ç”±è£½é€ å•†æ“æœ‰å’Œç¶“ç‡Ÿï¼Œé€šå¸¸éŠ·å”®è‡ªå®¶éå‰©ã€åœç”¢æˆ–ä¸è¦å¾‹å•†å“çš„é™åƒ¹é›¶å”®æ¥­å‹™æ˜¯ï¼Ÿ",
                a: "å·¥å» ç›´ç‡Ÿåº— (Factory outlet)",
                options: ["å·¥å» ç›´ç‡Ÿåº— (Factory outlet)", "ç¨ç«‹é™åƒ¹é›¶å”®å•†", "å€‰å„²ä¿±æ¨‚éƒ¨", "é€£é–ä¾¿åˆ©åº—"],
                exp: "Factory outlet æ˜¯ç”±è£½é€ å•†æ“æœ‰å’Œç¶“ç‡Ÿçš„é™åƒ¹é›¶å”®æ¥­å‹™ã€‚"
            },
            {
                q: "é—œæ–¼ã€ŒåŠ ç›Ÿçµ„ç¹” (Franchise organization)ã€ï¼Œä¸‹åˆ—æ•˜è¿°ä½•è€…æ­£ç¢ºï¼Ÿ",
                a: "åŠ ç›Ÿä¸»æ˜¯è³¼è²·æ“æœ‰å’Œç¶“ç‡Ÿæ¬Šçš„ç¨ç«‹å•†äºº",
                options: ["åŠ ç›Ÿä¸»æ˜¯è³¼è²·æ“æœ‰å’Œç¶“ç‡Ÿæ¬Šçš„ç¨ç«‹å•†äºº", "æ‰€æœ‰åˆ†åº—çš†ç”±ç¸½å…¬å¸ç›´æ¥æ“æœ‰èˆ‡ç®¡ç†", "æ˜¯ä¸€ç¨®ç”±æ‰¹ç™¼å•†ç™¼èµ·çš„è‡ªé¡˜é€£é–é«”ç³»", "ä¸»è¦ç”±è¾²ç”¢å“ç”Ÿç”¢è€…çµ„æˆ"],
                exp: "åŠ ç›Ÿæ˜¯ç‰¹è¨±äººèˆ‡åŠ ç›Ÿä¸»ä¹‹é–“çš„å¥‘ç´„é—œä¿‚ï¼ŒåŠ ç›Ÿä¸»æ˜¯è³¼è²·ç¶“ç‡Ÿæ¬Šçš„ç¨ç«‹å•†äºº (å¦‚ McDonald's, Subway)ã€‚"
            },
            {
                q: "é›¶å”®è¡ŒéŠ·æ±ºç­–çš„ç¬¬ä¸€æ­¥é€šå¸¸æ˜¯ï¼Ÿ",
                a: "é›¶å”®å€éš”èˆ‡ç›®æ¨™å¸‚å ´é¸æ“‡ (Retail segmentation and targeting)",
                options: ["é›¶å”®å€éš”èˆ‡ç›®æ¨™å¸‚å ´é¸æ“‡ (Retail segmentation and targeting)", "æ±ºå®šå•†åº—æ°£æ°›", "è¨­å®šä¿ƒéŠ·é ç®—", "é¸æ“‡åº—é¢ä½ç½®"],
                exp: "é›¶å”®å•†å¿…é ˆå…ˆå®šç¾©ç›®æ¨™å¸‚å ´ä¸¦é€²è¡Œå€éš”ï¼Œæ‰èƒ½æ±ºå®šå¦‚ä½•åœ¨å¸‚å ´ä¸­é€²è¡Œå·®ç•°åŒ–èˆ‡å®šä½ã€‚"
            },
            {
                q: "é›¶å”®å•†çš„ç”¢å“çµ„åˆ (Product assortment) æ±ºç­–ä¸­ï¼Œä¸åƒ…è¦æ±ºå®šç”¢å“ç¨®é¡ï¼Œé‚„éœ€è¦è€ƒæ…®ï¼Ÿ",
                a: "æœå‹™çµ„åˆ (Services mix) èˆ‡ å•†åº—æ°£æ°› (Store atmosphere)",
                options: ["æœå‹™çµ„åˆ (Services mix) èˆ‡ å•†åº—æ°£æ°› (Store atmosphere)", "æ‰¹ç™¼å•†çš„ç‰©æµæˆæœ¬", "å…¨çƒç¶“æ¿Ÿè¶¨å‹¢", "è£½é€ å•†çš„ç”Ÿç”¢æµç¨‹"],
                exp: "é›¶å”®å•†çš„ç”¢å“è®Šæ•¸åŒ…æ‹¬ï¼šç”¢å“çµ„åˆã€æœå‹™çµ„åˆä»¥åŠå•†åº—æ°£æ°›ã€‚"
            },
            {
                q: "Costco æˆ– Aldi é€™é¡é›¶å”®å•†ä¸»è¦æ¡ç”¨çš„åƒ¹æ ¼ç­–ç•¥æ˜¯ï¼Ÿ",
                a: "æ¯æ—¥ä½åƒ¹ (EDLP)",
                options: ["æ¯æ—¥ä½åƒ¹ (EDLP)", "é«˜ä½å®šåƒ¹ (High-low pricing)", "æ å¥ªå¼å®šåƒ¹", "æ’‡è„‚å®šåƒ¹"],
                exp: "EDLP (Everyday Low Pricing) å¼·èª¿æŒçºŒçš„ä½åƒ¹ï¼Œè€Œéé »ç¹çš„çŸ­æœŸä¿ƒéŠ· (High-low)ã€‚"
            },
            {
                q: "è³¼ç‰©ä¸­å¿ƒ (Shopping center) çš„å®šç¾©æ˜¯ï¼Ÿ",
                a: "ä½œç‚ºä¸€å€‹å–®ä½é€²è¡Œè¦åŠƒã€é–‹ç™¼ã€æ“æœ‰å’Œç®¡ç†çš„ä¸€çµ„é›¶å”®æ¥­å‹™",
                options: ["ä½œç‚ºä¸€å€‹å–®ä½é€²è¡Œè¦åŠƒã€é–‹ç™¼ã€æ“æœ‰å’Œç®¡ç†çš„ä¸€çµ„é›¶å”®æ¥­å‹™", "ä½æ–¼å¸‚ä¸­å¿ƒçš„å–®ä¸€å¤§å‹ç™¾è²¨å…¬å¸", "æ²¿è‘—é«˜é€Ÿå…¬è·¯è‡ªç„¶èšé›†çš„å•†åº—ç¾¤", "åƒ…å­˜åœ¨æ–¼ç¶²è·¯ä¸Šçš„è™›æ“¬å•†åŸ"],
                exp: "è³¼ç‰©ä¸­å¿ƒæ˜¯ä½œç‚ºä¸€å€‹æ•´é«”å–®ä½ä¾†è¦åŠƒã€é–‹ç™¼å’Œç®¡ç†çš„é›¶å”®èšè½ã€‚"
            },
            {
                q: "ã€Œæ‰¹ç™¼ (Wholesaling)ã€çš„ä¸»è¦æ´»å‹•å°è±¡æ˜¯ï¼Ÿ",
                a: "ç‚ºäº†è½‰å”®æˆ–å•†æ¥­ä½¿ç”¨è€Œè³¼è²·çš„äºº",
                options: ["ç‚ºäº†è½‰å”®æˆ–å•†æ¥­ä½¿ç”¨è€Œè³¼è²·çš„äºº", "æœ€çµ‚å€‹äººæ¶ˆè²»è€…", "åƒ…é™æ–¼æ”¿åºœæ©Ÿæ§‹", "åƒ…é™æ–¼åœ‹å¤–é€²å£å•†"],
                exp: "æ‰¹ç™¼æ¶‰åŠå°‡å•†å“éŠ·å”®çµ¦ç‚ºäº†è½‰å”® (Resale) æˆ–å•†æ¥­ä½¿ç”¨ (Business use) çš„è²·å®¶ã€‚"
            },
            {
                q: "ä¸‹åˆ—å“ªä¸€é …**ä¸æ˜¯**æ‰¹ç™¼å•†é€šå¸¸åŸ·è¡Œçš„é€šè·¯åŠŸèƒ½ï¼Ÿ",
                a: "ç›´æ¥è£½é€ ç”¢å“ (Manufacturing)",
                options: ["ç›´æ¥è£½é€ ç”¢å“ (Manufacturing)", "æ‹†ç®±/æ•£è£ (Bulk breaking)", "å€‰å„² (Warehousing)", "èè³‡ (Financing)"],
                exp: "æ‰¹ç™¼å•†çš„åŠŸèƒ½åŒ…æ‹¬éŠ·å”®ã€è³¼è²·ã€æ‹†ç®±ã€å€‰å„²ã€é‹è¼¸ã€èè³‡ã€é¢¨éšªæ‰¿æ“”ç­‰ï¼Œä½†ä¸åŒ…æ‹¬è£½é€ ã€‚"
            },
            {
                q: "ã€Œå•†äººæ‰¹ç™¼å•† (Merchant wholesaler)ã€èˆ‡ç¶“ç´€äºº/ä»£ç†å•†æœ€å¤§çš„å€åˆ¥åœ¨æ–¼ï¼Ÿ",
                a: "å•†äººæ‰¹ç™¼å•†æ“æœ‰å•†å“æ‰€æœ‰æ¬Š (Take title to goods)",
                options: ["å•†äººæ‰¹ç™¼å•†æ“æœ‰å•†å“æ‰€æœ‰æ¬Š (Take title to goods)", "å•†äººæ‰¹ç™¼å•†ä¸è™•ç†å¯¦é«”å•†å“", "å•†äººæ‰¹ç™¼å•†åƒ…æœå‹™æ–¼è¾²æ¥­å¸‚å ´", "ç¶“ç´€äººæ“æœ‰å•†å“æ‰€æœ‰æ¬Š"],
                exp: "Merchant wholesalers æ˜¯ç¨ç«‹æ“æœ‰çš„ä¼æ¥­ï¼Œæ“æœ‰å…¶è™•ç†å•†å“çš„æ‰€æœ‰æ¬Šï¼›ç¶“ç´€äººèˆ‡ä»£ç†å•†å‰‡ä¸æ“æœ‰æ‰€æœ‰æ¬Šã€‚"
            },
            {
                q: "ä¸æ“æœ‰å•†å“æ‰€æœ‰æ¬Šï¼Œä¸»è¦åŠŸèƒ½æ˜¯ä¿ƒæˆè²·è³£é›™æ–¹äº¤æ˜“ä¸¦æ”¶å–ä½£é‡‘çš„æ˜¯ï¼Ÿ",
                a: "ç¶“ç´€äºº (Broker)",
                options: ["ç¶“ç´€äºº (Broker)", "å·¥æ¥­ç¶“éŠ·å•†", "å¡è»Šæ‰¹ç™¼å•†", "ç›´é‹å•† (Drop shippers)"],
                exp: "ç¶“ç´€äºº (Broker) ä¸æ“æœ‰å•†å“ï¼Œä¸»è¦åŠŸèƒ½æ˜¯åª’åˆè²·è³£é›™æ–¹ä¸¦å”åŠ©è«‡åˆ¤ã€‚"
            },
            {
                q: "ä»£è¡¨è²·æ–¹æˆ–è³£æ–¹ï¼Œä¸”é—œä¿‚è¼ƒç‚ºã€Œé•·æœŸã€çš„æ‰¹ç™¼ä¸­é–“äººç¨±ç‚ºï¼Ÿ",
                a: "ä»£ç†å•† (Agent)",
                options: ["ä»£ç†å•† (Agent)", "ç¶“ç´€äºº (Broker)", "é›¶å”®å•†", "ä¾›æ‡‰å•†"],
                exp: "ä»£ç†å•† (Agent) èˆ‡è²·è³£é›™æ–¹çš„é—œä¿‚æ¯”ç¶“ç´€äººæ›´ç‚ºé•·æœŸä¸”ç©©å®šã€‚"
            },
            {
                q: "æ”¶åˆ°è¨‚å–®å¾Œï¼Œé¸æ“‡è£½é€ å•†ä¸¦ç”±è£½é€ å•†ç›´æ¥å‡ºè²¨çµ¦å®¢æˆ¶ï¼Œè‡ªå·±ä¸ç¶“æ‰‹åº«å­˜çš„æ‰¹ç™¼å•†æ˜¯ï¼Ÿ",
                a: "ç›´é‹å•† (Drop shipper)",
                options: ["ç›´é‹å•† (Drop shipper)", "è²¨æ¶æ‰¹ç™¼å•† (Rack jobber)", "å¡è»Šæ‰¹ç™¼å•† (Truck wholesaler)", "ç¾é‡‘è‡ªé‹æ‰¹ç™¼å•†"],
                exp: "Drop shippers æ”¶åˆ°è¨‚å–®å¾Œç”±è£½é€ å•†ç›´ç™¼ï¼Œä¸è™•ç†åº«å­˜æˆ–å¯¦é«”å•†å“ã€‚"
            },
            {
                q: "è¿‘å¹´ä¾†é›¶å”®æ¥­çš„ä¸»è¦è¶¨å‹¢ä¹‹ä¸€æ˜¯ï¼Ÿ",
                a: "å¤§å‹é›¶å”®å•† (Megaretailers) çš„å´›èµ·èˆ‡é›¶å”®ç§‘æŠ€çš„å¢é•·",
                options: ["å¤§å‹é›¶å”®å•† (Megaretailers) çš„å´›èµ·èˆ‡é›¶å”®ç§‘æŠ€çš„å¢é•·", "å®Œå…¨å›æ­¸å‚³çµ±çš„å°å‹é›œè²¨åº—æ¨¡å¼", "æ‰¹ç™¼å•†å®Œå…¨å–ä»£é›¶å”®å•†çš„è§’è‰²", "åœæ­¢å…¨çƒæ“´å¼µä»¥å°ˆæ³¨æœ¬åœ°å¸‚å ´"],
                exp: "Ch11 æåˆ°çš„è¶¨å‹¢åŒ…æ‹¬å¤§å‹é›¶å”®å•†å´›èµ·ã€ç›´æ•ˆ/ç·šä¸Š/è¡Œå‹•é›¶å”®å¢é•·ã€é›¶å”®ç§‘æŠ€çš„é‡è¦æ€§å¢åŠ ã€ç¶ è‰²é›¶å”®åŠå…¨çƒæ“´å¼µã€‚"
            }
        ];

        // --- éŠæˆ²ç‹€æ…‹ ---
        let currentQuestions = [];
        let currentIndex = 0;
        let correctCount = 0; // è¨˜éŒ„ç­”å°é¡Œæ•¸
        let userAnswers = []; // å„²å­˜ç”¨æˆ¶çš„ç­”é¡Œè¨˜éŒ„ {q, selected, correct, isCorrect, exp}

        // --- æ ¸å¿ƒé‚è¼¯å‡½æ•¸ ---

        // æ´—ç‰Œæ¼”ç®—æ³• (Fisher-Yates)
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // åˆå§‹åŒ–éŠæˆ²
        function startGame() {
            // 1. éš±è—æ­¡è¿é ï¼Œé¡¯ç¤ºéŠæˆ²é 
            document.getElementById('welcome-modal').classList.remove('active');
            document.getElementById('game-ui').style.display = 'flex';
            
            // 2. æº–å‚™é¡Œç›® (é›–èªªæ˜¯å›ºå®š20é¡Œï¼Œä½†é¸é …éœ€è¦éš¨æ©Ÿ)
            // è¤‡è£½é¡Œåº«ä»¥å…æ±™æŸ“æºè³‡æ–™
            currentQuestions = JSON.parse(JSON.stringify(questionsSource));
            
            // é¸é …éš¨æ©ŸåŒ–
            currentQuestions.forEach(q => {
                q.shuffledOptions = shuffle([...q.options]);
            });

            // 3. é‡ç½®ç‹€æ…‹
            currentIndex = 0;
            correctCount = 0; // é‡ç½®ç­”å°é¡Œæ•¸
            userAnswers = [];
            
            // 4. æ¸²æŸ“ç¬¬ä¸€é¡Œ
            renderQuestion();
        }

        function renderQuestion() {
            const qData = currentQuestions[currentIndex];
            
            // æ›´æ–°é€²åº¦
            document.getElementById('progress-text').innerText = `Q ${currentIndex + 1}/${currentQuestions.length}`;
            
            // æ›´æ–°é¡Œç›®
            document.getElementById('question-text').innerText = qData.q;
            
            // æ›´æ–°é¸é …
            const optsContainer = document.getElementById('options-container');
            optsContainer.innerHTML = '';
            
            qData.shuffledOptions.forEach(opt => {
                const btn = document.createElement('div');
                btn.className = 'option-btn';
                btn.innerText = opt;
                btn.onclick = () => selectOption(btn, opt);
                optsContainer.appendChild(btn);
            });

            // ç¦ç”¨ä¸‹ä¸€é¡ŒæŒ‰éˆ•
            document.getElementById('next-btn').disabled = true;
        }

        let currentSelection = null;

        function selectOption(btnElement, selectedText) {
            // æ¸…é™¤ä¹‹å‰çš„é¸æ“‡æ¨£å¼
            const allBtns = document.querySelectorAll('.option-btn');
            allBtns.forEach(b => b.classList.remove('selected'));
            
            // æ·»åŠ ç•¶å‰é¸æ“‡æ¨£å¼
            btnElement.classList.add('selected');
            currentSelection = selectedText;
            
            // å•Ÿç”¨ä¸‹ä¸€é¡ŒæŒ‰éˆ•
            document.getElementById('next-btn').disabled = false;
        }

        function nextQuestion() {
            if (!currentSelection) return;

            const qData = currentQuestions[currentIndex];
            const isCorrect = (currentSelection === qData.a);
            
            if (isCorrect) correctCount++;

            // è¨˜éŒ„ç­”é¡Œç‹€æ³
            userAnswers.push({
                question: qData.q,
                selected: currentSelection,
                correctAnswer: qData.a,
                isCorrect: isCorrect,
                explanation: qData.exp
            });

            // å‰é€²ä¸‹ä¸€é¡Œæˆ–çµæŸ
            currentIndex++;
            currentSelection = null;

            if (currentIndex < currentQuestions.length) {
                renderQuestion();
            } else {
                endGame();
            }
        }

        function endGame() {
            document.getElementById('game-ui').style.display = 'none';
            document.getElementById('result-modal').classList.add('active');
            
            // è¨ˆç®—ç¸½åˆ† (1é¡Œ5åˆ†)
            const totalScore = correctCount * 5;
            document.getElementById('final-score').innerText = totalScore;

            // è©•èªé‚è¼¯ (100åˆ†åˆ¶)
            let feedback = "";
            let color = "";
            if (totalScore >= 90) {
                feedback = "ğŸ‘‘ é›¶å”®å¤§å¸« (Master)ï¼š\nå¤ªé©šäººäº†ï¼æ‚¨å°é›¶å”®èˆ‡æ‰¹ç™¼çš„æ¦‚å¿µæŒæ¡å¾—çˆç«ç´”é’ï¼Œç°¡ç›´æ˜¯æ•™ç§‘æ›¸ç´šåˆ¥çš„è¡¨ç¾ï¼";
                color = "#00e676"; // Green
            } else if (totalScore >= 70) {
                feedback = "ğŸŒŸ å„ªç§€ç¶“ç† (Expert)ï¼š\nè¡¨ç¾å„ªç•°ï¼æ‚¨å°å¤§éƒ¨åˆ†æ ¸å¿ƒæ¦‚å¿µéƒ½å¾ˆæ¸…æ¥šï¼Œç¨åŠ è¤‡ç¿’ç´°ç¯€å°±èƒ½é”åˆ°å®Œç¾ã€‚";
                color = "#00e5ff"; // Blue
            } else if (totalScore >= 50) {
                feedback = "ğŸ’¼ æ½›åŠ›æ–°æ˜Ÿ (Apprentice)ï¼š\nåŠæ ¼äº†ï¼æ‚¨æŒæ¡äº†åŸºç¤çŸ¥è­˜ï¼Œä½†å°æ–¼ä¸€äº›å°ˆæœ‰åè©å’Œåˆ†é¡é‚„éœ€è¦å†åŠ å¼·å–”ã€‚";
                color = "#ffd740"; // Yellow
            } else {
                feedback = "ğŸ“š æ–°æ‰‹å¯¦ç¿’ (Novice)ï¼š\né‚„éœ€åŠªåŠ›ï¼å»ºè­°æ‚¨é‡æ–°é–±è®€ Chapter 11ï¼Œé‡æ¸…é›¶å”®å•†é¡å‹èˆ‡æ‰¹ç™¼åŠŸèƒ½çš„å·®ç•°ã€‚";
                color = "#ff5252"; // Red
            }
            const fbEl = document.getElementById('final-feedback');
            fbEl.innerText = feedback;
            fbEl.style.borderLeft = `4px solid ${color}`;
            fbEl.style.paddingLeft = "10px";

            // ç¹ªè£½åœ“é¤…åœ– (ä½¿ç”¨é¡Œæ•¸æ¯”ä¾‹)
            renderChart(correctCount, 20 - correctCount);

            // ç”Ÿæˆè©³è§£åˆ—è¡¨
            const list = document.getElementById('review-list');
            list.innerHTML = '';
            userAnswers.forEach((item, idx) => {
                const div = document.createElement('div');
                div.className = `review-item ${item.isCorrect ? 'correct' : 'wrong'}`;
                div.innerHTML = `
                    <div class="review-q">Q${idx+1}: ${item.question}</div>
                    <div class="review-a">æ‚¨çš„å›ç­”: ${item.selected} ${item.isCorrect ? 'âœ…' : 'âŒ'}</div>
                    ${!item.isCorrect ? `<div class="review-a" style="color:var(--success-color)">æ­£ç¢ºç­”æ¡ˆ: ${item.correctAnswer}</div>` : ''}
                    <div class="review-exp">ğŸ’¡ è§£æ: ${item.explanation}</div>
                `;
                list.appendChild(div);
            });
        }

        // Chart.js æ¸²æŸ“
        function renderChart(correct, wrong) {
            const ctx = document.getElementById('scoreChart').getContext('2d');
            
            // éŠ·æ¯€èˆŠåœ–è¡¨ (å¦‚æœæœ‰çš„è©±)
            if (window.myChart) window.myChart.destroy();

            window.myChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['æ­£ç¢º', 'éŒ¯èª¤'],
                    datasets: [{
                        data: [correct, wrong],
                        backgroundColor: ['#00e676', '#ff5252'],
                        borderWidth: 0,
                        hoverOffset: 4
                    }]
                },
                options: {
                    cutout: '75%',
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false }
                    },
                    animation: {
                        animateScale: true,
                        animateRotate: true
                    }
                }
            });
        }

    </script>
</body>
</html>